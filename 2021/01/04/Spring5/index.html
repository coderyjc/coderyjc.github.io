<!DOCTYPE html>
<html lang="en">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="ç¬”è®° | Spring5" />
    <meta name="hexo-theme-A4" content="v1.9.6" />
    <link rel="alternate icon" type="image/webp" href="/img/avatar.png">
    <title>Jingcun Yan</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--è¿”å›é¡¶éƒ¨css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--ç›®å½•-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery-bundle.min.css">


<meta name="generator" content="Hexo 7.3.0"></head>
    
    
        <style>
            .index-main{
                max-width:  880px;
            }
        </style>

    
    



    

    
    

    
    
    
    <body>
        <script src="/js/darkmode-js.min.js"></script>
        
        <script>
            const options = {
                bottom: '40px', // default: '32px'
                right: 'unset', // default: '32px'
                left: '42px', // default: 'unset'
                time: '0.3s', // default: '0.3s'
                mixColor: '#fff', // default: '#fff'
                backgroundColor: ' #e4e4e4 ',  // default: '#fff'
                buttonColorDark: '#100f2c',  // default: '#100f2c'
                buttonColorLight: '#fff', // default: '#fff'
                saveInCookies: true, // default: true,
                label: 'ğŸŒ“', // default: ''
                autoMatchOsTheme: true // default: true
            }
            const darkmode = new Darkmode(options);
            darkmode.showWidget();
        </script>
        
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/avatar.png" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Jingcun Yan</a> 
            <span class="description"></span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">é¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">æ–‡ç« </a></li>
            
        
            
                <li><a href="/collect/">æ”¶è—</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">
    

    
        
            
                <div class="post-main-title" style="text-align: center;">
                    ç¬”è®° | Spring5
                </div>
            
        
      
    

    

        
            <div class="post-head-meta-center">
        
                
                
                    
                     <span>å­—æ•°æ€»è®¡ï¼š8.9k</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span>é˜…è¯»ä¼°æ—¶ï¼š41åˆ†é’Ÿ</span>
                
                
            </div>
    

    <div class="post-md">
        
        <div class=".article-gallery"><blockquote>
<p>ç›®å‰æœ€æ–°ç‰ˆæœ¬æ˜¯Spring6ï¼Œæ­¤ç‰ˆæœ¬æš‚ä¸”åœæ­¢æ›´æ–°</p>
</blockquote>
<h1 id="Spring-5"><a href="#Spring-5" class="headerlink" title="Spring 5"></a>Spring 5</h1><h2 id="1-Spring-Concepts"><a href="#1-Spring-Concepts" class="headerlink" title="1. Spring Concepts"></a>1. Spring Concepts</h2><h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><p>Spring æ˜¯è½»é‡çº§çš„å¼€æºçš„ JavaEE æ¡†æ¶ </p>
<p>Spring å¯ä»¥è§£å†³ä¼ä¸šåº”ç”¨å¼€å‘çš„å¤æ‚æ€§ </p>
<p>Spring æœ‰ä¸¤ä¸ªæ ¸å¿ƒéƒ¨åˆ†ï¼šIOC å’Œ Aop </p>
<ul>
<li><p>IOCï¼šæ§åˆ¶åè½¬ï¼ŒæŠŠåˆ›å»ºå¯¹è±¡è¿‡ç¨‹äº¤ç»™ Spring è¿›è¡Œç®¡ç† </p>
</li>
<li><p>Aopï¼šé¢å‘åˆ‡é¢ï¼Œä¸ä¿®æ”¹æºä»£ç è¿›è¡ŒåŠŸèƒ½å¢å¼º</p>
</li>
</ul>
<p>Spring ç‰¹ç‚¹</p>
<ul>
<li>æ–¹ä¾¿è§£è€¦ï¼Œç®€åŒ–å¼€å‘ </li>
<li>Aop ç¼–ç¨‹æ”¯æŒ</li>
<li>æ–¹ä¾¿ç¨‹åºæµ‹è¯• </li>
<li>æ–¹ä¾¿å’Œå…¶ä»–æ¡†æ¶è¿›è¡Œæ•´åˆ </li>
<li>æ–¹ä¾¿è¿›è¡Œäº‹åŠ¡æ“ä½œ</li>
<li>é™ä½ API å¼€å‘éš¾åº¦</li>
</ul>
<h3 id="å…¥é—¨æ¡ˆä¾‹"><a href="#å…¥é—¨æ¡ˆä¾‹" class="headerlink" title="å…¥é—¨æ¡ˆä¾‹"></a>å…¥é—¨æ¡ˆä¾‹</h3><ol>
<li>åˆ›å»ºæ™®é€šJavaå·¥ç¨‹</li>
<li>å¯¼å…¥Spring5ç›¸å…³jaråŒ…</li>
<li>åˆ›å»ºæ™®é€šç±»å’Œæ™®é€šè¿”å›æ–¹æ³•</li>
<li>åˆ›å»ºSpringé…ç½®æ–‡ä»¶ï¼Œåœ¨é…ç½®æ–‡ä»¶é‡Œåˆ›å»ºå¯¹è±¡ï¼Œé…ç½®æ–‡ä»¶æ˜¯.xmlæ ¼å¼</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--é…ç½®Userå¯¹è±¡åˆ›å»º--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.User&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>ç¼–å†™æµ‹è¯•ä»£ç </li>
</ol>
<h2 id="2-IOC"><a href="#2-IOC" class="headerlink" title="2. IOC"></a>2. IOC</h2><h3 id="2-1-IOC-åº•å±‚åŸç†"><a href="#2-1-IOC-åº•å±‚åŸç†" class="headerlink" title="2.1 IOC åº•å±‚åŸç†"></a>2.1 IOC åº•å±‚åŸç†</h3><h4 id="ä»€ä¹ˆæ˜¯-IOC"><a href="#ä»€ä¹ˆæ˜¯-IOC" class="headerlink" title="ä»€ä¹ˆæ˜¯ IOC"></a>ä»€ä¹ˆæ˜¯ IOC</h4><p>ï¼ˆ1ï¼‰æ§åˆ¶åè½¬ï¼ŒæŠŠå¯¹è±¡åˆ›å»ºå’Œå¯¹è±¡ä¹‹é—´çš„è°ƒç”¨è¿‡ç¨‹ï¼Œäº¤ç»™ Spring è¿›è¡Œç®¡ç† </p>
<p>ï¼ˆ2ï¼‰ä½¿ç”¨ IOC ç›®çš„ï¼šä¸ºäº†è€¦åˆåº¦é™ä½ </p>
<p>ï¼ˆ3ï¼‰åšå…¥é—¨æ¡ˆä¾‹å°±æ˜¯ IOC å®ç°</p>
<h4 id="åº•å±‚åŸç†"><a href="#åº•å±‚åŸç†" class="headerlink" title="åº•å±‚åŸç†"></a>åº•å±‚åŸç†</h4><p>xmlè§£æã€å·¥å‚æ¨¡å¼ã€åå°„</p>
<p>å·¥å‚æ¨¡å¼ï¼š</p>
<p><a href="/img/image-20210104163554079.png" title="image-20210104163554079" class="gallery-item" style="box-shadow: none;"> <img src="/img/image-20210104163554079.png" alt="image-20210104163554079"></a></p>
<p>IOCè¿‡ç¨‹</p>
<p><a href="/img/image-20210104164919877.png" title="image-20210104164919877" class="gallery-item" style="box-shadow: none;"> <img src="/img/image-20210104164919877.png" alt="image-20210104164919877"></a></p>
<h3 id="2-2-IOC-æ¥å£ï¼ˆBeanFactoryï¼‰"><a href="#2-2-IOC-æ¥å£ï¼ˆBeanFactoryï¼‰" class="headerlink" title="2.2 IOC æ¥å£ï¼ˆBeanFactoryï¼‰"></a>2.2 IOC æ¥å£ï¼ˆBeanFactoryï¼‰</h3><p>1ã€IOC æ€æƒ³åŸºäº IOC å®¹å™¨å®Œæˆï¼ŒIOC å®¹å™¨åº•å±‚å°±æ˜¯å¯¹è±¡å·¥å‚ </p>
<p>2ã€Spring æä¾› IOC å®¹å™¨å®ç°ä¸¤ç§æ–¹å¼ï¼šï¼ˆä¸¤ä¸ªæ¥å£ï¼‰</p>
<ol>
<li><p>BeanFactoryï¼šIOC å®¹å™¨åŸºæœ¬å®ç°ï¼Œæ˜¯ Spring å†…éƒ¨çš„ä½¿ç”¨æ¥å£ï¼Œ<strong>ä¸æä¾›</strong>å¼€å‘äººè¿›è¡Œä½¿ç”¨ã€‚åŠ è½½é…ç½®æ–‡ä»¶æ—¶å€™ä¸ä¼šåˆ›å»ºå¯¹è±¡ï¼Œåœ¨è·å–å¯¹è±¡ï¼ˆä½¿ç”¨ï¼‰æ‰å»åˆ›å»ºå¯¹è±¡ </p>
</li>
<li><p>ApplicationContextï¼šBeanFactory æ¥å£çš„å­æ¥å£ï¼Œæä¾›æ›´å¤šæ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œä¸€èˆ¬ç”±å¼€å‘äºº å‘˜è¿›è¡Œä½¿ç”¨ã€‚åŠ è½½é…ç½®æ–‡ä»¶æ—¶å€™å°±ä¼šæŠŠåœ¨é…ç½®æ–‡ä»¶å¯¹è±¡è¿›è¡Œåˆ›å»ºã€è¿™ç§æ–¹å¼æ¯”è¾ƒå¥½ï¼Œå› ä¸ºåœ¨webé¡¹ç›®ä¸­æˆ‘ä»¬æ¨èæŠŠè€—è´¹æ—¶é—´å’Œèµ„æºçš„æ“ä½œåœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™è¿›è¡Œå¤„ç†ï¼ŒèŠ‚çº¦æ—¶é—´è€Œä¸æ˜¯èŠ‚çº¦ç©ºé—´ã€‘</p>
</li>
</ol>
<h3 id="2-3-IOC-æ“ä½œ-Bean-ç®¡ç†ï¼ˆåŸºäº-xmlï¼‰"><a href="#2-3-IOC-æ“ä½œ-Bean-ç®¡ç†ï¼ˆåŸºäº-xmlï¼‰" class="headerlink" title="2.3 IOC æ“ä½œ Bean ç®¡ç†ï¼ˆåŸºäº xmlï¼‰"></a>2.3 IOC æ“ä½œ Bean ç®¡ç†ï¼ˆåŸºäº xmlï¼‰</h3><p>Beanç®¡ç†æŒ‡çš„æ˜¯ä¸¤ä¸ªæ“ä½œ : Spring åˆ›å»ºå¯¹è±¡ã€Springæ³¨å…¥å±æ€§</p>
<p>Beanç®¡ç†æ“ä½œç”±ä¸¤ç§æ–¹å¼å®ç°: åŸºäºXMLé…ç½®æ–‡ä»¶å®ç°ã€åŸºäºæ³¨è§£å®ç°</p>
<p><strong>åˆ›å»ºå¯¹è±¡</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// bean.xml</span><br><span class="line"><span class="comment">&lt;!--é…ç½®Userå¯¹è±¡åˆ›å»º--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.User&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ–¹å¼ï¼š</p>
<ul>
<li>åœ¨Springé…ç½®æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨beanæ ‡ç­¾ï¼Œæ ‡ç­¾é‡Œé¢æ·»åŠ å¯¹åº”å±æ€§ï¼Œå°±å¯ä»¥å®ç°å¯¹è±¡åˆ›å»º</li>
<li>åœ¨ bean æ ‡ç­¾æœ‰å¾ˆå¤šå±æ€§ï¼Œä»‹ç»å¸¸ç”¨çš„å±æ€§<ul>
<li>id ï¼š å”¯ä¸€çš„æ ‡è¯†ï¼Œåœ¨è·å–å®ä¾‹çš„æ—¶å€™å°†idä¼ å…¥<code>User user = context.getBean(&quot;user&quot;, User.class);</code></li>
<li>class ï¼šç±»çš„å…¨è·¯å¾„ï¼ˆä¹Ÿå°±æ˜¯åŒ…çš„è·¯å¾„ï¼‰</li>
</ul>
</li>
<li>åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ï¼Œ<strong>é»˜è®¤</strong>æ‰§è¡Œ<strong>æ— å‚æ„é€ </strong>å®Œæˆå¯¹è±¡çš„åˆ›å»ºï¼ˆæ²¡æœ‰æ— å‚æ„é€ å°±ä¼šæŠ¥é”™ï¼‰</li>
</ul>
<h4 id="åŸºäºXMLæ³¨å…¥å±æ€§"><a href="#åŸºäºXMLæ³¨å…¥å±æ€§" class="headerlink" title="åŸºäºXMLæ³¨å…¥å±æ€§"></a><strong>åŸºäºXMLæ³¨å…¥å±æ€§</strong></h4><p>DIï¼šä¾èµ–æ³¨å…¥ï¼ˆæ³¨å…¥å±æ€§ï¼‰ï¼Œéœ€è¦åœ¨åˆ›å»ºå¯¹è±¡çš„åŸºç¡€ä¹‹ä¸Šå®Œæˆ</p>
<ol>
<li><p>setå‡½æ•°è¿›è¡Œæ³¨å…¥</p>
<ol>
<li><p>åˆ›å»ºç±»ï¼Œå®šä¹‰å±æ€§å’Œsetæ–¹æ³•ï¼ˆæœ€åŸå§‹çš„æ–¹æ³•ï¼Œä¸å†æ¼”ç¤ºï¼‰</p>
</li>
<li><p>åœ¨ spring é…ç½®æ–‡ä»¶é…ç½®å¯¹è±¡åˆ›å»ºï¼Œé…ç½®å±æ€§æ³¨å…¥</p>
</li>
</ol>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®Userå¯¹è±¡åˆ›å»º--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.User&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--name ä¸ºè¦æ³¨å…¥çš„å±æ€§åï¼Œ valueä¸ºå±æ€§å€¼--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å¼ ä¸‰&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;15&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æœ‰å‚æ„é€ è¿›è¡Œæ³¨å…¥</p>
<ol>
<li><p>ä½¿ç”¨æœ‰å‚æ„é€ åˆ›å»ºç±»ï¼ˆæœ€åŸå§‹çš„æ–¹æ³•ï¼Œä¸å†æ¼”ç¤ºï¼‰</p>
</li>
<li><p>åœ¨springé…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®</p>
</li>
</ol>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®Userå¯¹è±¡åˆ›å»º--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.User&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--name ä¸ºè¦æ³¨å…¥çš„å±æ€§åï¼Œ valueä¸ºå±æ€§å€¼--&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å¼ ä¸‰&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;15&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="å…¶ä»–ç±»å‹çš„XMLæ³¨å…¥"><a href="#å…¶ä»–ç±»å‹çš„XMLæ³¨å…¥" class="headerlink" title="å…¶ä»–ç±»å‹çš„XMLæ³¨å…¥"></a><strong>å…¶ä»–ç±»å‹çš„XMLæ³¨å…¥</strong></h4><ol>
<li><p>å­—é¢é‡</p>
<ol>
<li><p>nullå€¼</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">null</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å±æ€§å€¼åŒ…å«ç‰¹æ®Šç¬¦å·ï¼Œæ¯”å¦‚ å¼•å·</p>
<ol>
<li>è½¬ä¹‰ <code>&amp;lt;&amp;dt</code>ç­‰</li>
<li>å†™é“CDATAä¸­</li>
</ol>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--æ­¤æ—¶å§“åä¸ºå¸¦å¼•å·çš„ â€œå¼ ä¸‰â€ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>&lt;![CDATA[&quot;å¼ ä¸‰&quot;]]&gt;<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>æ³¨å…¥å±æ€§ - å¤–éƒ¨bean</p>
<ol>
<li>ç›´æ¥newå¤–éƒ¨beançš„å¯¹è±¡<code>UserDao userDao = new UserDaoImpl();</code> ï¼ˆä¼ ç»Ÿæ–¹æ³•ä¸å†æ¼”ç¤ºï¼‰</li>
<li>åœ¨xmlæ–‡ä»¶ä¸­é…ç½®åæ³¨å…¥ï¼ˆæœ‰å‚æ„é€ æˆ–è€…setï¼‰ <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">&lt;!--å®šä¹‰å±æ€§ã€ç”Ÿæˆsetæ–¹æ³•ã€åœ¨é…ç½®æ–‡ä»¶ä¸­ç”¨refæŠŠå…¶ä»–å¯¹è±¡æ³¨å…¥è¿›æ¥--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    1. serviceå’Œdaoå¯¹è±¡åˆ›å»º--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.service.UserService&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    2. æ³¨å…¥userDaoå¯¹è±¡</span></span><br><span class="line"><span class="comment">    nameå±æ€§ï¼šç±»é‡Œé¢å±æ€§çš„åç§°</span></span><br><span class="line"><span class="comment">    refå±æ€§ï¼šåˆ›å»ºuserDaoå¯¹è±¡beanæ ‡ç­¾çš„idå€¼--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.dao.UserDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>æ³¨å…¥å±æ€§ - å†…éƒ¨bean</p>
<p>ä¸€å¯¹å¤šçš„å…³ç³»ï¼ˆä¸€ä¸ªéƒ¨é—¨å¤šä¸ªå‘˜å·¥ï¼Œä¸€ä¸ªå‘˜å·¥ä¸€ä¸ªéƒ¨é—¨ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    å†…éƒ¨bean--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;emp&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.bean.Employee&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        è®¾ç½®ä¸¤ä¸ªæ™®é€šçš„å±æ€§--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;lisi&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;nan&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        è®¾ç½®å¯¹è±¡ç±»å‹å±æ€§--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dept&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dept&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.bean.Dept&quot;</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HR&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ³¨å…¥å±æ€§ - çº§è”bean</p>
<p> ä½¿ç”¨refå±æ€§å…³è”å¤–éƒ¨çš„bean</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    çº§è”bean--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;emp&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.bean.Employee&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        è®¾ç½®ä¸¤ä¸ªæ™®é€šçš„å±æ€§--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;lisi&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;nan&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        è®¾ç½®å¯¹è±¡ç±»å‹å±æ€§--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dept&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dept&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dept&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.bean.Dept&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HR&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>IOCæ“ä½œBeanç®¡ç†ï¼Œxmlæ³¨å…¥é›†åˆå±æ€§</p>
</li>
</ol>
<p>ç¬¬ä¸€ç§æ–¹æ³•éƒ½æ˜¯ç›´æ¥ç”¨setæ–¹æ³•è¿›è¡Œèµ‹å€¼ï¼Œä¸å†æ¼”ç¤ºï¼Œä»¥ä¸‹æ˜¯xmlé…ç½®å±æ€§</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;stu&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.sets.Stu&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ•°ç»„ç±»å‹å±æ€§æ³¨å…¥--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;courses&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>Java<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>Oracle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--list ç±»å‹æ³¨å…¥--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>å¼ ä¸‰<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>å°ä¸‰å­<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--mapç±»å‹æ³¨å…¥--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;Java&quot;</span> <span class="attr">value</span>=<span class="string">&quot;java&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;MySQL&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--setç±»å‹æ³¨å…¥--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;set&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>Java<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>Python<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æå‡ºé—®é¢˜: </p>
<ul>
<li><p>èƒ½ä¸èƒ½åœ¨é›†åˆä¸­ä½¿ç”¨å¼•ç”¨ç±»å‹? â€“åœ¨é›†åˆä¸­è®¾ç½®å¯¹è±¡ç±»å‹çš„å€¼</p>
</li>
<li><p>èƒ½ä¸èƒ½å¼•ç”¨å…¬å…±çš„é›†åˆï¼Œä½¿å¾—å¤šä¸ªç±»éƒ½å¯ä»¥å¼•ç”¨è¿™ä¸ªé›†åˆå¯¹è±¡ï¼Ÿ â€“ æŠŠé›†åˆæ³¨å…¥éƒ¨åˆ†æå–å‡ºæ¥</p>
</li>
</ul>
<ol start="6">
<li>åœ¨é›†åˆä¸­è®¾ç½®å¯¹è±¡ç±»å‹çš„å€¼</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;stu&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.sets.Stu&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--list ç±»å‹æ³¨å…¥--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;java&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ref</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;python&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ref</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--äº‹å…ˆå£°æ˜ä¸¤ä¸ªCourseç±»--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;java&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.sets.Course&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;JAVA&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;python&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.sets.Course&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;PYTHON&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="7">
<li>æå–é›†åˆæ³¨å…¥éƒ¨åˆ†</li>
</ol>
<p>é¦–å…ˆä¿®æ”¹beansæ ‡ç­¾</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:util</span>=<span class="string">&quot;http://www.springframework.org/schema/util&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag"> http://www.springframework.org/schema/util</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/util/spring-util.xsd&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>é…ç½®æ–‡ä»¶é…ç½®æ–¹å¼ï¼š</p>
<p>å…ˆç”¨utilç›¸å…³æ ‡ç­¾è®¾ç½®å±æ€§ï¼Œ å†ç”¨refè¿›è¡Œå¼•ç”¨</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">util:list</span> <span class="attr">id</span>=<span class="string">&quot;bookList&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>æ–—ç½—å¤§é™†<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>æ–—ç ´è‹ç©¹<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">util:list</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;book&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.bean.Book&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookList&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="FactoryBean"><a href="#FactoryBean" class="headerlink" title="FactoryBean"></a><strong>FactoryBean</strong></h4><p>Springæœ‰ä¸¤ç§ç±»å‹çš„bean, ä¸€ç§äº‹æ™®é€šbeanï¼Œå¦ä¸€ç§æ˜¯å·¥å‚bean</p>
<p>æ™®é€šbeanï¼šåœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„beanç±»å‹å°±æ˜¯è¿”å›ç±»å‹</p>
<p>å·¥å‚beanï¼šåœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„beanç±»å‹å¯ä»¥å’Œè¿”å›ç±»å‹ä¸ä¸€æ ·ï¼Œå…·ä½“è¿”å›å†…å®¹åœ¨æ¥å£å®ç°ä¸­çš„getObjectä¸­è¿›è¡Œå®šä¹‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyBean.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyBean</span> <span class="keyword">implements</span> <span class="title class_">FactoryBean</span>&lt;Book&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Book <span class="title function_">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Book</span>();</span><br><span class="line">        <span class="comment">// è®¾ç½®å±æ€§</span></span><br><span class="line">        book.setName(Collections.singletonList(<span class="string">&quot;&lt;Hello&gt;&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> book;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// çœç•¥å…¶ä»–ä¸¤ä¸ªç©ºå‡½æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// bean.xml</span></span><br><span class="line">&lt;bean name=<span class="string">&quot;myBean&quot;</span> class=<span class="string">&quot;com.Jancoyan.spring.Factory.MyBean&quot;</span>&gt;&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// test.java</span></span><br><span class="line"><span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;bean.xml&quot;</span>);</span><br><span class="line"><span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> context.getBean(<span class="string">&quot;myBean&quot;</span>, Book.class);</span><br></pre></td></tr></table></figure>

<h4 id="beançš„ä½œç”¨åŸŸ"><a href="#beançš„ä½œç”¨åŸŸ" class="headerlink" title="beançš„ä½œç”¨åŸŸ"></a><strong>beançš„ä½œç”¨åŸŸ</strong></h4><p>åœ¨Springé‡Œé¢è®¾ç½®åˆ›å»ºçš„beanæ˜¯å•å®ä¾‹è¿˜æ˜¯å¤šå®ä¾‹ï¼ˆé»˜è®¤æ˜¯å•å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸€æ¬¡ç”¨beanè·å–å®ä¾‹çš„æ—¶å€™éƒ½æ˜¯è·å–çš„åŒä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼‰ï¼Œå¦‚ä½•è®¾ç½®å¤šå®ä¾‹è¿˜æ˜¯å•å®ä¾‹ï¼Ÿ</p>
<ul>
<li>åœ¨é…ç½®æ–‡ä»¶çš„beanæ ‡ç­¾ä¸­é€šè¿‡è®¾ç½®å±æ€§ scope è¿›è¡Œè®¾ç½®<ul>
<li>singleton ï¼š é»˜è®¤ï¼Œå•å®ä¾‹ï¼Œ<strong>åŠ è½½é…ç½®æ–‡ä»¶</strong>çš„æ—¶å€™å°±ä¼šåŠ è½½å•å®ä¾‹å¯¹è±¡ã€‚</li>
<li>prototypeï¼šæ‰‹åŠ¨è®¾ç½®ï¼Œå¤šå®ä¾‹ï¼Œåœ¨<strong>è°ƒç”¨getBeanæ–¹æ³•</strong>çš„æ—¶å€™åˆ›å»ºå¤šå®ä¾‹å¯¹è±¡ã€‚</li>
</ul>
</li>
</ul>
<h4 id="beanç”Ÿå‘½å‘¨æœŸ"><a href="#beanç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="beanç”Ÿå‘½å‘¨æœŸ"></a><strong>beanç”Ÿå‘½å‘¨æœŸ</strong></h4><ol>
<li>é€šè¿‡æ„é€ å™¨åˆ›å»ºbeanå®ä¾‹ï¼ˆæ— å‚æ„é€ ï¼‰</li>
<li>ä¸ºbeançš„å±æ€§è®¾ç½®å€¼å’Œå¯¹å…¶ä»–beançš„å¼•ç”¨ï¼ˆè°ƒç”¨setæ–¹æ³•ï¼‰</li>
<li>è°ƒç”¨beançš„åˆå§‹åŒ–æ–¹æ³•ï¼ˆéœ€è¦è¿›è¡Œé…ç½®ï¼‰<ol>
<li>é…ç½®åˆå§‹åŒ–æ–¹æ³•ï¼šè®¾ç½®beanæ ‡ç­¾çš„init-methodå±æ€§å€¼ä¸ºåˆå§‹åŒ–æ–¹æ³•å</li>
</ol>
</li>
<li>beanå¯ä»¥ä½¿ç”¨ï¼ˆå¯¹è±¡è·å–åˆ°äº†ï¼‰</li>
<li>å½“å®¹å™¨å…³é—­çš„æ—¶å€™ï¼Œè°ƒç”¨beançš„é”€æ¯æ–¹æ³•ï¼ˆéœ€è¦è‡ªå·±é…ç½®é”€æ¯æ–¹æ³•ï¼‰<ol>
<li>é…ç½®é”€æ¯æ–¹æ³•ï¼šè®¾ç½®beanæ ‡ç­¾çš„destory-methodå€¼ä¸ºé”€æ¯æ–¹æ³•å</li>
</ol>
</li>
</ol>
<p>åŠ ä¸Šbeançš„åç½®å¤„ç†å™¨ä¹‹åï¼Œç”Ÿå‘½å‘¨æœŸå˜ä¸º7æ­¥</p>
<ol>
<li>é€šè¿‡æ„é€ å™¨åˆ›å»ºbeanå®ä¾‹ï¼ˆæ— å‚æ„é€ ï¼‰</li>
<li>ä¸ºbeançš„å±æ€§è®¾ç½®å€¼å’Œå¯¹å…¶ä»–beançš„å¼•ç”¨ï¼ˆè°ƒç”¨setæ–¹æ³•ï¼‰</li>
<li>æŠŠbeançš„å®ä¾‹ä¼ é€’beanåç½®å¤„ç†å™¨çš„æ–¹æ³•</li>
<li>è°ƒç”¨beançš„åˆå§‹åŒ–æ–¹æ³•ï¼ˆéœ€è¦è¿›è¡Œé…ç½®ï¼‰<ol>
<li>é…ç½®åˆå§‹åŒ–æ–¹æ³•ï¼šè®¾ç½®beanæ ‡ç­¾çš„init-methodå±æ€§å€¼ä¸ºåˆå§‹åŒ–æ–¹æ³•å</li>
</ol>
</li>
<li>æŠŠbeançš„å®ä¾‹ä¼ é€’beanåç½®å¤„ç†å™¨çš„æ–¹æ³•</li>
<li>beanå¯ä»¥ä½¿ç”¨ï¼ˆå¯¹è±¡è·å–åˆ°äº†ï¼‰</li>
<li>å½“å®¹å™¨å…³é—­çš„æ—¶å€™ï¼Œè°ƒç”¨beançš„é”€æ¯æ–¹æ³•ï¼ˆéœ€è¦è‡ªå·±é…ç½®é”€æ¯æ–¹æ³•ï¼‰<ol>
<li>é…ç½®é”€æ¯æ–¹æ³•ï¼šè®¾ç½®beanæ ‡ç­¾çš„destory-methodå€¼ä¸ºé”€æ¯æ–¹æ³•å</li>
</ol>
</li>
</ol>
<p>åœ¨åˆå§‹åŒ–ä¹‹å‰å’Œä¹‹åä¼šåˆ†åˆ«å°†beanä¼ ç»™åç½®å¤„ç†å™¨ï¼Œåç½®å¤„ç†å™¨ä¼šå¯¹æ‰€æœ‰é…ç½®æ–‡ä»¶ä¸­çš„beanè¿›è¡Œåç½®å¤„ç†å™¨çš„æ·»åŠ ã€‚</p>
<p>åç½®å¤„ç†å™¨å®ç°ï¼šå†™ä¸€ä¸ªç±»ç»§æ‰¿BeanPostProcessor å¹¶Overrideé‡Œé¢çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œç„¶ååœ¨é…ç½®æ–‡ä»¶ä¸­å†™ä¸Šè¿™ä¸ªç±»çš„beanï¼Œspringä¼šè‡ªåŠ¨å°†å…¶è¯†åˆ«ä¸ºåç½®å¤„ç†å™¨ï¼ˆå› ä¸ºå®ç°äº†BeanPostProcessoræ¥å£ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyBeanPost</span> <span class="keyword">implements</span> <span class="title class_">BeanPostProcessor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;myBeanPost&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.Jancoyan.spring.Factory.MyBean&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="xmlæ–¹å¼çš„è‡ªåŠ¨è£…é…"><a href="#xmlæ–¹å¼çš„è‡ªåŠ¨è£…é…" class="headerlink" title="xmlæ–¹å¼çš„è‡ªåŠ¨è£…é…"></a><strong>xmlæ–¹å¼çš„è‡ªåŠ¨è£…é…</strong></h4><p>æ‰‹åŠ¨è£…é…ï¼šåœ¨xmlé…ç½®æ–‡ä»¶ä¸­beanä¸­è®¾ç½®propertyæ ‡ç­¾ï¼Œæ‰‹åŠ¨è®¾ç½®å€¼</p>
<p>è‡ªåŠ¨è£…é…ï¼šæ ¹æ®æŒ‡å®šçš„è£…é…è§„åˆ™ï¼ˆå±æ€§åç§°æˆ–è€…å±æ€§ç±»å‹ï¼‰ï¼ŒSpringè‡ªåŠ¨å°†åŒ¹é…çš„å±æ€§å€¼è¿›è¡Œæ³¨å…¥</p>
<p><mark>åœ¨å®é™…å¼€å‘ä¸­ä½¿ç”¨æ¯”è¾ƒå°‘, ä¸å†æ¼”ç¤º</mark></p>
<h4 id="å¼•å…¥å¤–éƒ¨å±æ€§æ–‡ä»¶ï¼ˆæ•°æ®åº“é…ç½®ï¼‰"><a href="#å¼•å…¥å¤–éƒ¨å±æ€§æ–‡ä»¶ï¼ˆæ•°æ®åº“é…ç½®ï¼‰" class="headerlink" title="å¼•å…¥å¤–éƒ¨å±æ€§æ–‡ä»¶ï¼ˆæ•°æ®åº“é…ç½®ï¼‰"></a><strong>å¼•å…¥å¤–éƒ¨å±æ€§æ–‡ä»¶ï¼ˆæ•°æ®åº“é…ç½®ï¼‰</strong></h4><ol>
<li><p>ç›´æ¥é…ç½®æ•°æ®åº“ä¿¡æ¯</p>
<ol>
<li>é…ç½®å¾·é²ä¼Šè¿æ¥æ± </li>
<li>å¼•å…¥å¾·é²ä¼Šè¿æ¥æ± çš„jaråŒ…<code>druid.jar</code></li>
</ol>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/userDb&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å¼•å…¥å¤–éƒ¨å±æ€§æ–‡ä»¶é…ç½®æ•°æ®åº“è¿æ¥æ± </p>
</li>
</ol>
<p>åˆ›å»ºå¤–éƒ¨å±æ€§æ–‡ä»¶ï¼Œpropertiesæ–‡ä»¶ï¼Œå†™æ•°æ®åº“ä¿¡æ¯ï¼ˆé”®å€¼å¯¹çš„æ–¹å¼å†™æ•°æ®åº“ä¿¡æ¯ï¼‰</p>
<p>æŠŠå¤–éƒ¨çš„propertieså±æ€§æ–‡ä»¶å¼•å…¥åˆ°springæ–‡ä»¶ä¸­ï¼Œå¼•å…¥contextåç§°ç©ºé—´ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:util</span>=<span class="string">&quot;http://www.springframework.org/schema/util&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag"> http://www.springframework.org/schema/util</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/util/spring-util.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag"> http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨springé…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨æ ‡ç­¾å¼•å…¥å¤–éƒ¨å±æ€§æ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--å¼•å…¥å¤–éƒ¨å±æ€§æ–‡ä»¶--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:jdbc.properties&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½®è¿æ¥æ± --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;prop.driverClass&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;prop.url&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;prop.userName&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;prop.password&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-4-IOC-æ“ä½œ-Bean-ç®¡ç†ï¼ˆåŸºäºæ³¨è§£ï¼‰"><a href="#2-4-IOC-æ“ä½œ-Bean-ç®¡ç†ï¼ˆåŸºäºæ³¨è§£ï¼‰" class="headerlink" title="2.4 IOC æ“ä½œ Bean ç®¡ç†ï¼ˆåŸºäºæ³¨è§£ï¼‰"></a>2.4 IOC æ“ä½œ Bean ç®¡ç†ï¼ˆåŸºäºæ³¨è§£ï¼‰</h3><p>ä»€ä¹ˆæ˜¯æ³¨è§£</p>
<ul>
<li>æ³¨è§£æ˜¯ä»£ç ç‰¹æ®Šæ ‡è®°ï¼Œæ ¼å¼ï¼š@æ³¨è§£åç§°(å±æ€§åç§°&#x3D;å±æ€§å€¼, å±æ€§åç§°&#x3D;å±æ€§å€¼..)</li>
</ul>
<p>ä½¿ç”¨æ³¨è§£ï¼Œæ³¨è§£ä½œç”¨åœ¨ç±»ä¸Šé¢ï¼Œæ–¹æ³•ä¸Šé¢ï¼Œå±æ€§ä¸Šé¢</p>
<p>ä½¿ç”¨æ³¨è§£ç›®çš„ï¼šç®€åŒ– xml é…ç½®</p>
<p>Springé’ˆå¯¹Beanç®¡ç†ä¸­åˆ›å»ºå¯¹è±¡æä¾›æ³¨è§£</p>
<ol>
<li>@Comment æ™®é€šçš„</li>
<li>@Service  å»ºè®®ç”¨åœ¨ä¸šåŠ¡é€»è¾‘å±‚</li>
<li>@Controller å»ºè®®ç”¨åœ¨webå±‚</li>
<li>@Repository å»ºè®®ç”¨åœ¨DAOå±‚</li>
</ol>
<p>è¿™å››ä¸ªæ³¨è§£åŠŸèƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½å¯ä»¥ç”¨æ¥åˆ›å»ºBeanå®ä¾‹ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¹ æƒ¯æŠŠä¸åŒçš„æ³¨è§£ç”¨åœ¨ä¸åŒçš„å±‚ä¸­ï¼Œä»¥ä¾¿è°ƒç†æ¸…æ™°</p>
<h4 id="åŸºäºæ³¨è§£æ–¹å¼çš„å¯¹è±¡çš„åˆ›å»º"><a href="#åŸºäºæ³¨è§£æ–¹å¼çš„å¯¹è±¡çš„åˆ›å»º" class="headerlink" title="åŸºäºæ³¨è§£æ–¹å¼çš„å¯¹è±¡çš„åˆ›å»º"></a>åŸºäºæ³¨è§£æ–¹å¼çš„å¯¹è±¡çš„åˆ›å»º</h4><p>æ­¥éª¤</p>
<ol>
<li>å¼•å…¥ä¾èµ– <code>spring-aop.jar</code></li>
<li>å¼€å¯ç»„ä»¶æ‰«æ - å¼•å…¥contextåç§°ç©ºé—´</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:util</span>=<span class="string">&quot;http://www.springframework.org/schema/util&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag"> http://www.springframework.org/schema/util</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/util/spring-util.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag"> http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¼€å¯ç»„ä»¶æ‰«æ</span></span><br><span class="line"><span class="comment"> 		1 å¦‚æœæ‰«æå¤šä¸ªåŒ…ï¼ŒåŒ…å’ŒåŒ…ä¹‹é—´ç”¨é€—å·éš”å¼€</span></span><br><span class="line"><span class="comment">		2 æ‰«æåŒ…çš„ä¸Šå±‚ç›®å½•</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.Jancoyan.spring.Factory, com.Jancoyan.spring.bean&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>åˆ›å»ºç±»ï¼Œåœ¨ç±»ä¸Šé¢æ·»åŠ åˆ›å»ºå¯¹è±¡æ³¨è§£</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ³¨è§£é‡Œé¢valueå±æ€§å€¼å¯ä»¥ä¸å†™</span></span><br><span class="line"><span class="comment">// å¦‚æœä¸å†™ï¼Œé»˜è®¤å€¼æ˜¯ç±»åç§°çš„é¦–å­—æ¯å°å†™å½¢å¼</span></span><br><span class="line"><span class="meta">@Component( value = &quot;userService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è®¾ç½®å“ªäº›æ³¨è§£è¿›è¡Œæ‰«æå’Œä¸è¿›è¡Œæ‰«æï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--ç¤ºä¾‹ 1</span></span><br><span class="line"><span class="comment"> use-default-filters=&quot;false&quot; è¡¨ç¤ºç°åœ¨ä¸ä½¿ç”¨é»˜è®¤ filterï¼Œè‡ªå·±é…ç½® filter</span></span><br><span class="line"><span class="comment"> context:include-filter ï¼Œè®¾ç½®æ‰«æå“ªäº›å†…å®¹</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.atguigu&quot;</span> <span class="attr">use-defaultfilters</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag"><span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--ç¤ºä¾‹ 2</span></span><br><span class="line"><span class="comment"> ä¸‹é¢é…ç½®æ‰«æåŒ…æ‰€æœ‰å†…å®¹</span></span><br><span class="line"><span class="comment"> context:exclude-filterï¼š è®¾ç½®å“ªäº›å†…å®¹ä¸è¿›è¡Œæ‰«æ</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.atguigu&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag"><span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="åŸºäºæ³¨è§£å®ç°å±æ€§æ³¨å…¥"><a href="#åŸºäºæ³¨è§£å®ç°å±æ€§æ³¨å…¥" class="headerlink" title="åŸºäºæ³¨è§£å®ç°å±æ€§æ³¨å…¥"></a>åŸºäºæ³¨è§£å®ç°å±æ€§æ³¨å…¥</h4><ol>
<li><p>@AutoWiredï¼šæ ¹æ®å±æ€§ç±»å‹è¿›è¡Œè‡ªåŠ¨è£…é…</p>
<ol>
<li>æŠŠserviceå’Œdaoå¯¹è±¡åˆ›å»ºï¼Œåœ¨serviceå’Œdaoç±»æ·»åŠ åˆ›å»ºå¯¹è±¡æ³¨é‡Š</li>
<li>åœ¨serviceä¸­æ³¨å…¥daoå¯¹è±¡ï¼Œåœ¨serviceç±»æ·»åŠ daoç±»å‹å±æ€§ï¼Œåœ¨å±æ€§ä¸Šé¢ä½¿ç”¨æ³¨è§£ï¼ˆä¸éœ€è¦æ·»åŠ setæ–¹æ³•ï¼‰</li>
</ol>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service(&quot;userService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">	<span class="comment">// å®šä¹‰daoç±»å‹å±æ€§</span></span><br><span class="line">    <span class="comment">// ä¸éœ€è¦æ·»åŠ setæ–¹æ³•</span></span><br><span class="line">    <span class="comment">// æ·»åŠ æ³¨å…¥å±æ€§æ³¨è§£ autowired</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Service add...&quot;</span>);</span><br><span class="line">        userDao.test();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>@Qualifierï¼šæ ¹æ®å±æ€§åç§°è¿›è¡Œæ³¨å…¥</p>
<ol>
<li>åº”è¯¥å’Œ@AutoWireä¸€èµ·ä½¿ç”¨</li>
</ol>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UserDao</span></span><br><span class="line"><span class="meta">@Component(&quot;userDao_1&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDao</span> <span class="keyword">implements</span> <span class="title class_">Dao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;UserDao....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Service</span></span><br><span class="line"><span class="meta">@Component(&quot;userService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœè¿™ä¸ªæ¥å£æœ‰å¤šä¸ªå®ç°ç±»å°±ä¸çŸ¥é“æ‰¾å“ªä¸ªå®ç°ç±»</span></span><br><span class="line">    <span class="comment">// valueå€¼å°±æ˜¯å°†è¿™ä¸ªå®ç°ç±»æ‰¾åˆ°</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(value = &quot;userDao_1&quot;)</span> <span class="comment">// æ ¹æ®åç§°è¿›è¡Œæ³¨å…¥</span></span><br><span class="line">    <span class="keyword">private</span> Dao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Service add...&quot;</span>);</span><br><span class="line">        userDao.test();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>@Resourceï¼šå¯ä»¥æ ¹æ®ç±»å‹æ³¨å…¥ï¼Œä¹Ÿèƒ½æ ¹æ®å±æ€§åç§°æ³¨å…¥</p>
<ol>
<li><mark>ä¸å»ºè®®ä½¿ç”¨</mark></li>
<li>ç±»å‹æ³¨å…¥ç›´æ¥åŠ @Resource</li>
<li>åç§°æ³¨å…¥åŠ ä¸Š@Resourceï¼ˆname &#x3D; â€œâ€ï¼‰ åç§°å†™å¯¹è±¡å</li>
</ol>
</li>
<li><p>@Valueï¼šæ³¨å…¥æ™®é€šç±»å‹å±æ€§</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;&lt;é©¬ä¿å›½&gt;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="å®Œå…¨æ³¨è§£å¼€å‘"><a href="#å®Œå…¨æ³¨è§£å¼€å‘" class="headerlink" title="å®Œå…¨æ³¨è§£å¼€å‘"></a>å®Œå…¨æ³¨è§£å¼€å‘</h4><ol>
<li>åˆ›å»ºé…ç½®ç±»ï¼Œæ›¿ä»£xmlé…ç½®æ–‡ä»¶</li>
</ol>
<p>@Configuration<br>@ComponentScan(basePackages &#x3D; â€œcom.Jancoyan.springâ€)<br>public class SpringConfig {<br>}</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2.</span> ç¼–å†™æµ‹è¯•ç±»</span><br><span class="line"></span><br><span class="line">java</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span></span><br><span class="line"> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">        <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> context.getBean(<span class="string">&quot;userService&quot;</span>, UserService.class);</span><br><span class="line">        userService.add();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>ApplicationContext context = new  AnnotationConfigApplicationContext(SpringConfig.class);</code></p>
<h2 id="3-AOP"><a href="#3-AOP" class="headerlink" title="3. AOP"></a>3. AOP</h2><h4 id="3-1-æ¦‚å¿µå’ŒåŸç†"><a href="#3-1-æ¦‚å¿µå’ŒåŸç†" class="headerlink" title="3.1 æ¦‚å¿µå’ŒåŸç†"></a>3.1 æ¦‚å¿µå’ŒåŸç†</h4><p>ä»€ä¹ˆæ˜¯ AOP ï¼Ÿé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆæ–¹é¢ï¼‰</p>
<p>åˆ©ç”¨ AOP å¯ä»¥å¯¹ä¸šåŠ¡é€»è¾‘çš„å„ä¸ªéƒ¨åˆ†è¿›è¡Œéš”ç¦»ï¼Œä»è€Œä½¿å¾— ä¸šåŠ¡é€»è¾‘å„éƒ¨åˆ†ä¹‹é—´çš„è€¦åˆåº¦é™ä½ï¼Œæé«˜ç¨‹åºçš„å¯é‡ç”¨æ€§ï¼ŒåŒæ—¶æé«˜äº†å¼€å‘çš„æ•ˆç‡ã€‚</p>
<p>é€šä¿—æè¿°ï¼šä¸é€šè¿‡ä¿®æ”¹æºä»£ç æ–¹å¼ï¼Œåœ¨ä¸»å¹²åŠŸèƒ½é‡Œé¢æ·»åŠ æ–°åŠŸèƒ½ </p>
<p>ä½¿ç”¨ç™»å½•ä¾‹å­è¯´æ˜ AOPï¼š</p>
<p><a href="/img/image-20210105160436913.png" title="image-20210105160436913" class="gallery-item" style="box-shadow: none;"> <img src="/img/image-20210105160436913.png" alt="image-20210105160436913"></a></p>
<p>AOPåº•å±‚ä½¿ç”¨åŠ¨æ€ä»£ç†</p>
<ul>
<li>æœ‰æ¥å£æƒ…å†µï¼Œä½¿ç”¨JDKåŠ¨æ€ä»£ç†<ul>
<li>åˆ›å»ºæ¥å£å®ç°ç±»ä»£ç†å¯¹è±¡å¢å¼ºç±»çš„æ–¹æ³•</li>
</ul>
</li>
</ul>
<p><a href="/img/image-20210105161355902.png" title="image-20210105161355902" class="gallery-item" style="box-shadow: none;"> <img src="/img/image-20210105161355902.png" alt="image-20210105161355902"></a></p>
<ul>
<li>æ²¡æœ‰æ¥å£æƒ…å†µï¼Œä½¿ç”¨CGLIBåŠ¨æ€ä»£ç†</li>
</ul>
<p><a href="/img/image-20210105161457964.png" title="image-20210105161457964" class="gallery-item" style="box-shadow: none;"> <img src="/img/image-20210105161457964.png" alt="image-20210105161457964"></a><br>AOPï¼ˆJDKåŠ¨æ€ä»£ç†ï¼‰</p>
<p><mark>å¯ä»¥ä¸æŒæ¡ï¼Œæˆ‘ä»¬æœ‰ä¸“é—¨çš„å°è£…ç±»</mark></p>
<p>ä½¿ç”¨JDKåŠ¨æ€ä»£ç†ï¼Œä½¿ç”¨Proxyç±»é‡Œé¢çš„æ–¹æ³•åˆ›å»ºä»£ç†å¯¹è±¡</p>
<ol>
<li>è°ƒç”¨newProxyInstanceæ–¹æ³•ï¼Œå…¶ä¸­æœ‰ä¸‰ä¸ªå‚æ•°ï¼›1ã€ç±»åŠ è½½å™¨ï¼›2ã€å¢å¼ºæ–¹æ³•æ‰€åœ¨çš„ç±»ï¼Œè¿™ä¸ªç±»å®ç°çš„æ¥å£ï¼Œæ”¯æŒå¤šä¸ªæ¥å£ï¼›3ã€å®ç°æ¥å£InvocationHandlerï¼Œåˆ›å»ºä»£ç†å¯¹è±¡ï¼Œå†™å¢å¼ºçš„æ–¹æ³•</li>
</ol>
<p>åˆ›å»ºæ¥å£ï¼Œå®šä¹‰æ–¹æ³•</p>
<p>åˆ›å»ºæ¥å£å®ç°ç±»ï¼Œå®ç°æ–¹æ³•</p>
<p>ä½¿ç”¨Proxyç±»åˆ›å»ºæ¥å£ä»£ç†å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//UserDao</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(String id)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//UserDaoImpl</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(String id)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;update...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//JDKåŠ¨æ€ä»£ç†</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDKProxy</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºæ¥å£å®ç°ç±»çš„ä»£ç†å¯¹è±¡</span></span><br><span class="line">        Class[] interfaces = &#123;UserDao.class&#125;;</span><br><span class="line">        <span class="type">UserDaoImpl</span> <span class="variable">userDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDaoImpl</span>();</span><br><span class="line">        <span class="type">UserDao</span> <span class="variable">dao</span> <span class="operator">=</span> (UserDao) Proxy.newProxyInstance(JDKProxy.class.getClassLoader(), interfaces, <span class="keyword">new</span> <span class="title class_">UserDaoProxy</span>(userDao));</span><br><span class="line">        <span class="type">int</span> <span class="variable">rst</span> <span class="operator">=</span> dao.add(<span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line">        System.out.println(rst);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä»£ç†å¯¹è±¡ä»£ç </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserDaoProxy</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Object object;</span><br><span class="line">    <span class="comment">// 1ã€ æŠŠåˆ›å»ºçš„æ˜¯è°çš„ä»£ç†å¯¹è±¡ï¼Œ æŠŠè¿™ä¸ªâ€œè°â€ä¼ é€’è¿›æ¥</span></span><br><span class="line">    <span class="comment">// æœ‰å‚æ„é€ ä¼ é€’</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserDaoProxy</span><span class="params">(Object obj)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.object = obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¢å¼ºçš„éƒ¨åˆ†</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">//æ–¹æ³•ä¹‹å‰å¤„ç†</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Pre...  å½“å‰æ‰§è¡Œçš„æ–¹æ³•æ˜¯&quot;</span> + method.getName() + <span class="string">&quot; ä¼ é€’çš„å‚æ•°æ˜¯...&quot;</span> + Arrays.toString(args));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¢«å¢å¼ºçš„æ–¹æ³•æ‰§è¡Œ</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">res</span> <span class="operator">=</span> method.invoke(object, args);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(method.getName().equals(<span class="string">&quot;add&quot;</span>))&#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯addæ–¹æ³•è¿›è¡Œæ€æ ·çš„å¤„ç†ã€‚ã€‚ã€‚</span></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ–¹æ³•ä¹‹åå¤„ç†</span></span><br><span class="line">        System.out.println(<span class="string">&quot;After... &quot;</span> + res);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><mark>ä»¥ä¸Šå†…å®¹å¯ä»¥ä¸æŒæ¡</mark></p>
<p>Springæ¡†æ¶ä¸€èˆ¬éƒ½æ˜¯åŸºäºAspectJå®ç°AOPæ“ä½œ</p>
<p>ä»€ä¹ˆæ˜¯AspectJï¼ŸAspectJä¸æ˜¯Springçš„ç»„æˆéƒ¨åˆ†ï¼Œä¸€èˆ¬æŠŠAspectJå’ŒSpringæ¡†æ¶ä¸€èµ·ä½¿ç”¨è¿›è¡ŒAOPæ“ä½œ</p>
<p>åŸºäºAspectJå®ç°AOPæ“ä½œï¼š</p>
<ul>
<li>åŸºäºxmlé…ç½®æ–‡ä»¶å®ç°</li>
<li>åŸºäºæ³¨è§£æ–¹å¼å®ç°ï¼ˆä½¿ç”¨ï¼‰</li>
</ul>
<p>å¼•å…¥ä¾èµ–ï¼š </p>
<p><a href="/img/image-20210106092108559.png" title="image-20210106092108559" class="gallery-item" style="box-shadow: none;"> <img src="/img/image-20210106092108559.png" alt="image-20210106092108559"></a><br>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼š</p>
<p>ä½œç”¨ï¼šçŸ¥é“å¯¹å“ªä¸ªç±»é‡Œé¢çš„å“ªä¸ªæ–¹æ³•è¿›è¡Œå¢å¼º</p>
<p>è¯­æ³•ï¼š<code>execution([æƒé™ä¿®é¥°ç¬¦][è¿”å›ç±»å‹][ç±»å…¨è·¯å¾„][æ–¹æ³•åç§°]([å‚æ•°åˆ—è¡¨]))</code></p>
<p>ä¾‹1:  com.Jancoyan.Spring.dao.UserDaoé‡Œé¢çš„ add() è¿›è¡Œå¢å¼º</p>
<p><code>* com.Jancoyan.Spring.dao.UserDao.add(..)</code> * è¡¨ç¤ºæ‰€æœ‰çš„ä¿®é¥°ç¬¦ï¼Œ .. è¡¨ç¤ºæ–¹æ³•ä¸­çš„æ‰€æœ‰å‚æ•°</p>
<p>ä¾‹2: com.Jancoyan.Spring.dao.UserDaoé‡Œé¢çš„ æ‰€æœ‰æ–¹æ³• è¿›è¡Œå¢å¼º</p>
<p><code>* com.Jancoyan.Spring.dao.UserDao.*(..)</code> * è¡¨ç¤ºæ‰€æœ‰çš„ä¿®é¥°ç¬¦ï¼Œ .. è¡¨ç¤ºæ–¹æ³•ä¸­çš„æ‰€æœ‰å‚æ•°</p>
<p>ä¾‹3:  com.Jancoyan.Spring.daoé‡Œé¢çš„ æ‰€æœ‰ç±»çš„ æ‰€æœ‰æ–¹æ³• è¿›è¡Œå¢å¼º</p>
<p><code>* com.Jancoyan.Spring.dao.*.*(..)</code> * è¡¨ç¤ºæ‰€æœ‰çš„ä¿®é¥°ç¬¦ï¼Œ .. è¡¨ç¤ºæ–¹æ³•ä¸­çš„æ‰€æœ‰å‚æ•°</p>
<h4 id="3-2-æ“ä½œæœ¯è¯­"><a href="#3-2-æ“ä½œæœ¯è¯­" class="headerlink" title="3.2 æ“ä½œæœ¯è¯­"></a>3.2 æ“ä½œæœ¯è¯­</h4><ol>
<li>è¿æ¥ç‚¹ï¼šç±»ä¸­èƒ½è¢«å¢å¼ºçš„æ–¹æ³•</li>
<li>åˆ‡å…¥ç‚¹ï¼šå®é™…è¢«å¢å¼ºçš„æ–¹æ³•</li>
<li>é€šçŸ¥ï¼ˆå¢å¼ºï¼‰ï¼šå®é™…å¢å¼ºçš„éƒ¨åˆ†<ol>
<li>å‰ç½®é€šçŸ¥ ã€ä¹‹å‰æ‰§è¡Œ</li>
<li>åç½®é€šçŸ¥ ã€ä¹‹åæ‰§è¡Œ</li>
<li>ç¯ç»•é€šçŸ¥ ã€ä¹‹å‰å’Œä¹‹åéƒ½æ‰§è¡Œ</li>
<li>å¼‚å¸¸é€šçŸ¥ ã€å¼‚å¸¸çš„æ—¶å€™æ‰é€šçŸ¥</li>
<li>æœ€ç»ˆé€šçŸ¥ ã€ç±»ä¼¼äºfinally</li>
</ol>
</li>
<li>åˆ‡é¢ï¼šæ˜¯ä¸€ä¸ªåŠ¨ä½œã€‚å°†é€šçŸ¥åº”ç”¨åˆ°åˆ‡å…¥ç‚¹çš„è¿‡ç¨‹</li>
</ol>
<h4 id="3-3-AspectJæ³¨è§£"><a href="#3-3-AspectJæ³¨è§£" class="headerlink" title="3.3 AspectJæ³¨è§£"></a>3.3 AspectJæ³¨è§£</h4><ol>
<li><p>åˆ›å»ºç±»ï¼Œåœ¨ç±»ä¸­åˆ›å»ºæ–¹æ³•</p>
</li>
<li><p>åˆ›å»ºå¢å¼ºç±»ï¼Œç¼–å†™å¢å¼ºé€»è¾‘</p>
<ol>
<li>åœ¨å¢å¼ºç±»é‡Œé¢åˆ›å»ºæ–¹æ³•ï¼Œè®©ä¸åŒçš„æ–¹æ³•ä»£è¡¨ä¸åŒçš„é€šçŸ¥ç±»å‹</li>
</ol>
</li>
<li><p>è¿›è¡Œé€šçŸ¥çš„é…ç½®</p>
<ol>
<li>åœ¨springé…ç½®æ–‡ä»¶ä¸­å¼€å¯æ³¨è§£æ‰«æ</li>
</ol>
<p> å¼•å…¥åç§°ç©ºé—´contextå’Œaop</p>
<p> <code>&lt;context:component-scan base-package=&quot;com.Jancoyan.spring.Bean&quot;&gt;&lt;/context:component-scan&gt;</code></p>
<ol>
<li>ä½¿ç”¨æ³¨è§£åˆ›å»ºUserå’ŒUserProxyå¯¹è±¡ï¼ˆ@Componentï¼‰</li>
<li>åœ¨å¢å¼ºç±»ä¸Šé¢æ·»åŠ æ³¨è§£ @Aspect</li>
<li>åœ¨springé…ç½®æ–‡ä»¶ä¸­å¼€å¯ç”Ÿæˆä»£ç†å¯¹è±¡</li>
</ol>
<p> <code>&lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;</code></p>
</li>
<li><p>é…ç½®ä¸åŒç±»å‹çš„é€šçŸ¥</p>
<ol>
<li>åœ¨å¢å¼ºç±»çš„é‡Œé¢ï¼Œåœ¨ä½œä¸ºé€šçŸ¥æ–¹æ³•ä¸Šé¢æ·»åŠ é€šçŸ¥ç±»å‹æ³¨è§£ï¼Œä½¿ç”¨åˆ‡å…¥ç‚¹è¡¨è¾¾å¼é…ç½®</li>
</ol>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// User.java</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;add....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// UserProxy.java</span></span><br><span class="line"><span class="comment">// å¢å¼ºçš„ç±»</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserProxy</span> &#123;</span><br><span class="line">    <span class="comment">// å‰ç½®é€šçŸ¥</span></span><br><span class="line">    <span class="meta">@Before(value = &quot;execution(* com.Jancoyan.spring.Bean.User.add(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;before...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// bean.xml</span></span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;beans xmlns=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="line">       xmlns:context=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="line">       xmlns:aop=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span><br><span class="line">       xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">       xsi:schemaLocation=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="line"><span class="string">       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd</span></span><br><span class="line"><span class="string">       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--    å¼€å¯æ³¨è§£æ‰«æ--&gt;</span><br><span class="line">    &lt;context:component-scan base-<span class="keyword">package</span>=<span class="string">&quot;com.Jancoyan.spring.Bean&quot;</span>&gt;&lt;/context:component-scan&gt;</span><br><span class="line">&lt;!--    å¼€å¯Aspectç”Ÿæˆä»£ç†å¯¹è±¡--&gt;</span><br><span class="line">    &lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;</span><br><span class="line">&lt;/beans&gt;</span><br><span class="line"><span class="comment">// Test.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;bean.xml&quot;</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> context.getBean(<span class="string">&quot;user&quot;</span>, User.class);</span><br><span class="line">        user.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>æ­£å¸¸æƒ…å†µä¸‹ä¸åŒç±»å‹çš„é€šçŸ¥çš„è¾“å‡ºæ—¶æœºï¼š</p>
<ul>
<li>ç¯ç»•ä¹‹å‰</li>
<li>before</li>
<li>add</li>
<li>ç¯ç»•ä¹‹å</li>
<li>after</li>
<li>afterReturning</li>
</ul>
<p>ã€Afterthrowingã€‘åœ¨æŠ›å‡ºå¼‚å¸¸ä¹‹å‰æ‰§è¡Œ</p>
<p>å¦‚æœæœ‰äº†å¼‚å¸¸ï¼Œåˆ™æ‰§è¡Œé¡ºåºä¸ºï¼š</p>
<ul>
<li>ç¯ç»•ä¹‹å‰</li>
<li>before</li>
<li>after</li>
<li>afterthrowing</li>
</ul>
<p>ç›¸åŒåˆ‡å…¥ç‚¹çš„æŠ½å–ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç›¸åŒåˆ‡å…¥ç‚¹æŠ½å–</span></span><br><span class="line"><span class="meta">@Pointcut(value = &quot;execution(* com.atguigu.spring5.aopanno.User.add(..))&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pointdemo</span><span class="params">()</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å‰ç½®é€šçŸ¥</span></span><br><span class="line"><span class="comment">//@Before æ³¨è§£è¡¨ç¤ºä½œä¸ºå‰ç½®é€šçŸ¥</span></span><br><span class="line"><span class="meta">@Before(value = &quot;pointdemo()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span> &#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;before.........&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªæ–¹æ³•çš„å¤šä¸ªå¢å¼ºç±»ï¼Œè®¾ç½®ä»–ä»¬çš„ä¼˜å…ˆçº§  - åœ¨å¢å¼ºç±»ä¸Šé¢æ·»åŠ æ³¨è§£ @Order(æ•°å­—)  æ•°å­—è¶Šå°è¶Šé«˜</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Order(0)</span> <span class="comment">// è®¾ç½®ä¼˜å…ˆçº§</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersonProxy</span> &#123;</span><br><span class="line">    <span class="meta">@Before(value = &quot;execution(* com.Jancoyan.spring.Bean.User.add(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Person before,,,&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="3-4-AspectJé…ç½®æ–‡ä»¶"><a href="#3-4-AspectJé…ç½®æ–‡ä»¶" class="headerlink" title="3.4 AspectJé…ç½®æ–‡ä»¶"></a>3.4 AspectJé…ç½®æ–‡ä»¶</h4><p><mark>å®é™…å¼€å‘ä¸­å°‘ä½¿ç”¨ï¼Œä½œä¸ºäº†è§£å³å¯</mark></p>
<p>1ã€åˆ›å»ºä¸¤ä¸ªç±»ï¼Œå¢å¼ºç±»å’Œè¢«å¢å¼ºç±»ï¼Œåˆ›å»ºæ–¹æ³•</p>
<p>2ã€åœ¨ spring é…ç½®æ–‡ä»¶ä¸­åˆ›å»ºä¸¤ä¸ªç±»å¯¹è±¡</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--åˆ›å»ºå¯¹è±¡--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;book&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.atguigu.spring5.aopxml.Book&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookProxy&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.atguigu.spring5.aopxml.BookProxy&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3ã€åœ¨ spring é…ç½®æ–‡ä»¶ä¸­é…ç½®åˆ‡å…¥ç‚¹</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½® aop å¢å¼º--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--åˆ‡å…¥ç‚¹--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;p&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(*</span></span></span><br><span class="line"><span class="string"><span class="tag">com.atguigu.spring5.aopxml.Book.buy(..))&quot;</span>/&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--é…ç½®åˆ‡é¢--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;bookProxy&quot;</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--å¢å¼ºä½œç”¨åœ¨å…·ä½“çš„æ–¹æ³•ä¸Š--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;before&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;p&quot;</span>/&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="4-JDBC-Template"><a href="#4-JDBC-Template" class="headerlink" title="4. JDBC Template"></a>4. JDBC Template</h2><h3 id="åŸç†å’Œæ¦‚å¿µ"><a href="#åŸç†å’Œæ¦‚å¿µ" class="headerlink" title="åŸç†å’Œæ¦‚å¿µ"></a>åŸç†å’Œæ¦‚å¿µ</h3><p>ä»€ä¹ˆæ˜¯ JdbcTemplate ï¼ŸSpring æ¡†æ¶å¯¹ JDBC è¿›è¡Œå°è£…ï¼Œä½¿ç”¨ JdbcTemplate æ–¹ä¾¿å®ç°å¯¹æ•°æ®åº“æ“ä½œ</p>
<ol>
<li>å¼•å…¥ç›¸å…³jaråŒ…</li>
</ol>
<p><a href="/img/image-20210106104856037.png" title="image-20210106104856037" class="gallery-item" style="box-shadow: none;"> <img src="/img/image-20210106104856037.png" alt="image-20210106104856037"></a><br>2. åœ¨springé…ç½®æ–‡ä»¶ä¸­é…ç½®æ•°æ®åº“è¿æ¥æ± </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ•°æ®åº“è¿æ¥æ±  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">destroy-method</span>=<span class="string">&quot;close&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql:///user_db&quot;</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>é…ç½®jdbcTemplateå¯¹è±¡ï¼Œæ³¨å…¥DataSource</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- JdbcTemplate å¯¹è±¡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--æ³¨å…¥ dataSource--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>åˆ›å»ºserviceç±»å’Œdaoç±»ï¼Œåœ¨daoæ³¨å…¥jdbcTemplateå¯¹è±¡</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç»„ä»¶æ‰«æ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.atguigu&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Service</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line"> <span class="comment">//æ³¨å…¥ dao</span></span><br><span class="line"> <span class="meta">@Autowired</span></span><br><span class="line"> <span class="keyword">private</span> BookDao bookDao;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// dao</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line"> <span class="comment">//æ³¨å…¥ JdbcTemplate</span></span><br><span class="line"> <span class="meta">@Autowired</span></span><br><span class="line"> <span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å•ä¸€æ“ä½œ"><a href="#å•ä¸€æ“ä½œ" class="headerlink" title="å•ä¸€æ“ä½œ"></a>å•ä¸€æ“ä½œ</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--bean.xml--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--   å¼€å¯æ³¨è§£æ‰«æ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.Jancoyan.spring.Bean&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    æ•°æ®åº“è¿æ¥æ± --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;close&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/spring&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;333&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    é…ç½®JdbcTemplateå¯¹è±¡ï¼Œæ³¨å…¥DataSource--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    ç»„ä»¶æ‰«æ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.Jancoyan.spring&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="å¢åˆ æ”¹"><a href="#å¢åˆ æ”¹" class="headerlink" title="å¢åˆ æ”¹"></a>å¢åˆ æ”¹</h4><p>ä½¿ç”¨ <code>jdbcTemplate.update(sql, args);</code></p>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šsqlè¯­å¥</li>
<li>ç¬¬äºŒä¸ªå‚æ•°ï¼šsqlè¯­å¥ä¸­å ä½ç¬¦ä»£è¡¨çš„å…ƒç´ ï¼Œç±»å‹ä¸º Object[]</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;bean.xml&quot;</span>);</span><br><span class="line">        <span class="type">Service</span> <span class="variable">service</span> <span class="operator">=</span> context.getBean(<span class="string">&quot;service&quot;</span>, Service.class);</span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">        student.setId(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">        student.setName(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">        service.add(student);</span><br><span class="line">        student.setName(<span class="string">&quot;hahaha&quot;</span>);</span><br><span class="line">        service.update(student);</span><br><span class="line">        service.delete(<span class="string">&quot;123&quot;</span>);        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// service</span></span><br><span class="line"><span class="meta">@org</span>.springframework.stereotype.Service</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Service</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookDao bookDao;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Student student)</span>&#123;</span><br><span class="line">        bookDao.add(student);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(String id)</span>&#123;</span><br><span class="line">        bookDao.delete(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Student student)</span>&#123;</span><br><span class="line">        bookDao.update(student);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// dao</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¢åŠ æ“ä½œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Student student)</span> &#123;</span><br><span class="line">        <span class="comment">// 1.åˆ›å»ºsql</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into t_student values(?, ?)&quot;</span>;</span><br><span class="line">        <span class="comment">// è°ƒç”¨æ–¹æ³•å®ç°</span></span><br><span class="line">        Object[] args = &#123;student.getId(), student.getName()&#125;;</span><br><span class="line">        <span class="comment">// è¿”å›æˆåŠŸçš„ç»“æœæ•°é‡</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">rst</span> <span class="operator">=</span> jdbcTemplate.update(sql, args);</span><br><span class="line">        System.out.println(<span class="string">&quot;å¢åŠ &quot;</span> + rst);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤æ“ä½œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(String id)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from t_student where id = ?&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">rst</span> <span class="operator">=</span> jdbcTemplate.update(sql, id);</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ é™¤&quot;</span>  +  rst);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿®æ”¹æ“ä½œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Student student)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update t_student set name = ? where id = ?&quot;</span>;</span><br><span class="line">        Object[] args = &#123;student.getName(), student.getId()&#125;;</span><br><span class="line">        <span class="type">int</span> <span class="variable">update</span> <span class="operator">=</span> jdbcTemplate.update(sql, args);</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¿®æ”¹&quot;</span> + update);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="è¿”å›æŸä¸ªå€¼çš„æŸ¥è¯¢"><a href="#è¿”å›æŸä¸ªå€¼çš„æŸ¥è¯¢" class="headerlink" title="è¿”å›æŸä¸ªå€¼çš„æŸ¥è¯¢"></a>è¿”å›æŸä¸ªå€¼çš„æŸ¥è¯¢</h4><p>è°ƒç”¨å‡½æ•°<code>jdbcTemplate.queryForObject(String sql,Class class)</code></p>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šsqlè¯­å¥</li>
<li>ç¬¬äºŒä¸ªå‚æ•°ï¼šè¿”å›ç»“æœçš„ç»“æœç±»</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">totalNumber</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select count(*) from t_student&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> jdbcTemplate.queryForObject(sql, Integer.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="è¿”å›å¯¹è±¡çš„æŸ¥è¯¢"><a href="#è¿”å›å¯¹è±¡çš„æŸ¥è¯¢" class="headerlink" title="è¿”å›å¯¹è±¡çš„æŸ¥è¯¢"></a>è¿”å›å¯¹è±¡çš„æŸ¥è¯¢</h4><p>è°ƒç”¨å‡½æ•° <code>jdbcTemplate.queryForObject(String sql, new BeanPropertyRowMapper&lt;è¿”å›ç±»å‹&gt;(è¿”å›ç±»å‹Class), å‚æ•°åˆ—è¡¨)</code></p>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šsqlè¯­å¥</li>
<li>ç¬¬äºŒä¸ªå‚æ•°ï¼šnew BeanPropertyRowMapper&lt;è¿”å›ç±»å‹&gt;(è¿”å›ç±»å‹çš„Class)</li>
<li>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šsqlä¸­çš„å ä½ç¬¦ï¼Œç±»å‹ä¸º Object[]ï¼Œå¯ä»¥æ²¡æœ‰</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Student <span class="title function_">selectStudent</span><span class="params">(String id)</span>&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from t_student where id = ?&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> jdbcTemplate.queryForObject(sql, <span class="keyword">new</span> <span class="title class_">BeanPropertyRowMapper</span>&lt;Student&gt;(Student.class), id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="è¿”å›é›†åˆçš„æŸ¥è¯¢"><a href="#è¿”å›é›†åˆçš„æŸ¥è¯¢" class="headerlink" title="è¿”å›é›†åˆçš„æŸ¥è¯¢"></a>è¿”å›é›†åˆçš„æŸ¥è¯¢</h4><p>è°ƒç”¨å‡½æ•° <code>jdbcTemplate.query(sql, new BeanPropertyRowMapper&lt;Student&gt;(Student.class),å‚æ•°åˆ—è¡¨)</code></p>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šsqlè¯­å¥</li>
<li>ç¬¬äºŒä¸ªå‚æ•°ï¼šnew BeanPropertyRowMapper&lt;è¿”å›ç±»å‹&gt;(è¿”å›ç±»å‹çš„Class)</li>
<li>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šsqlä¸­çš„å ä½ç¬¦ï¼Œç±»å‹ä¸º Object[]ï¼Œå¯ä»¥æ²¡æœ‰</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Student&gt; <span class="title function_">selectStudent</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from t_student&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> jdbcTemplate.query(sql, <span class="keyword">new</span> <span class="title class_">BeanPropertyRowMapper</span>&lt;Student&gt;(Student.class));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ‰¹é‡æ“ä½œ"><a href="#æ‰¹é‡æ“ä½œ" class="headerlink" title="æ‰¹é‡æ“ä½œ"></a>æ‰¹é‡æ“ä½œ</h3><p>è°ƒç”¨å‡½æ•°<code>jdbcTemplate.batchUpdate(String sql, List&lt;Object[]&gt; batchArgs)</code></p>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºsqlè¯­å¥</li>
<li>ç¬¬äºŒä¸ªä¸ºsqlä¸­çš„å‚æ•°, List&lt;Object&gt; ç±»å‹</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ‰¹é‡æ·»åŠ </span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">batchAddBook</span><span class="params">(List&lt;Object[]&gt; batchArgs)</span> &#123;</span><br><span class="line">	<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into t_book values(?,?,?)&quot;</span>;</span><br><span class="line">	<span class="type">int</span>[] ints = jdbcTemplate.batchUpdate(sql, batchArgs);</span><br><span class="line">	System.out.println(Arrays.toString(ints));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰¹é‡ä¿®æ”¹</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">batchUpdateBook</span><span class="params">(List&lt;Object[]&gt; batchArgs)</span> &#123;</span><br><span class="line">	<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update t_book set username=?, ustatus=? where user_id=?&quot;</span>;</span><br><span class="line">	<span class="type">int</span>[] ints = jdbcTemplate.batchUpdate(sql, batchArgs);</span><br><span class="line">	System.out.println(Arrays.toString(ints));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰¹é‡åˆ é™¤</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">batchDeleteBook</span><span class="params">(List&lt;Object[]&gt; batchArgs)</span> &#123;</span><br><span class="line">	<span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from t_book where user_id=?&quot;</span>;</span><br><span class="line">	<span class="type">int</span>[] ints = jdbcTemplate.batchUpdate(sql, batchArgs);</span><br><span class="line">	System.out.println(Arrays.toString(ints));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-Transaction-Management"><a href="#5-Transaction-Management" class="headerlink" title="5. Transaction Management"></a>5. Transaction Management</h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>webåº”ç”¨ä¸‰å±‚æ¶æ„ï¼šwebå±‚ã€serviceå±‚ã€daoå±‚</p>
<p>å»ºè®®å°†äº‹åŠ¡æ·»åŠ åˆ°serviceå±‚ä¸­</p>
<p>æœ‰ä¸¤ç§æ–¹å¼</p>
<ul>
<li>ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†ã€ä¸ä½¿ç”¨ã€‘</li>
<li>å£°æ˜å¼äº‹åŠ¡ç®¡ç†ã€ä½¿ç”¨ã€‘<ul>
<li>åŸºäºæ³¨è§£æ–¹å¼ã€ä½¿ç”¨ã€‘</li>
<li>åŸºäºxmlé…ç½®æ–‡ä»¶æ–¹å¼</li>
</ul>
</li>
</ul>
<p>æ€»ç»“ï¼š ä½¿ç”¨<strong>æ³¨è§£å£°æ˜å¼äº‹åŠ¡ç®¡ç†</strong></p>
<p>åº•å±‚ä½¿ç”¨åˆ°äº†AOP</p>
<p>äº‹åŠ¡ç®¡ç†çš„API</p>
<ul>
<li>æä¾›ä¸€ä¸ªæ¥å£äº‹åŠ¡ç®¡ç†å™¨ï¼Œè¿™ä¸ªæ¥å£é’ˆå¯¹ä¸åŒçš„æ¡†æ¶å®ç°äº†ä¸åŒçš„å®ç°ç±»</li>
</ul>
<h3 id="æ³¨è§£å£°æ˜å¼äº‹åŠ¡ç®¡ç†"><a href="#æ³¨è§£å£°æ˜å¼äº‹åŠ¡ç®¡ç†" class="headerlink" title="æ³¨è§£å£°æ˜å¼äº‹åŠ¡ç®¡ç†"></a>æ³¨è§£å£°æ˜å¼äº‹åŠ¡ç®¡ç†</h3><ol>
<li>åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®äº‹åŠ¡ç®¡ç†å™¨</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    åˆ›å»ºäº‹åŠ¡ç®¡ç†å™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        æ³¨å…¥æ•°æ®æº--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>åœ¨é…ç½®æ–‡ä»¶ä¸­å¼€å¯äº‹åŠ¡æ³¨è§£</p>
<ol>
<li>å¼€å¯åç§°ç©ºé—´ <code>tx</code></li>
</ol>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag"> http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag"> http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/aop/spring-aop.xsd </span></span></span><br><span class="line"><span class="string"><span class="tag">                     http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/tx/spring-tx.xsd&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>å¼€å¯äº‹åŠ¡æ³¨è§£</li>
</ol>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--å¼€å¯äº‹åŠ¡æ³¨è§£--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">tx:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨serviceç±»ä¸Šé¢ï¼ˆè·å–serviceç±»çš„æ–¹æ³•ä¸Šé¢æ·»åŠ äº‹åŠ¡æ³¨è§£</p>
<ol>
<li>@Transactional å¯ä»¥æ·»åŠ åˆ°ç±»ä¸Šæˆ–è€…æ–¹æ³•ä¸Š</li>
<li>å¦‚æœæ·»åŠ åˆ°ç±»ä¸Šï¼Œè¡¨ç¤ºç±»ä¸­çš„æ‰€æœ‰çš„æ–¹æ³•æ·»åŠ äº†äº‹åŠ¡</li>
<li>å¦‚æœæ·»åŠ åˆ°äº†æ–¹æ³•ä¸Šï¼Œè¡¨ç¤ºæ–¹æ³•æ·»åŠ äº†äº‹åŠ¡</li>
</ol>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">()</span>&#123;</span><br><span class="line">        userDao.reduceMoney();</span><br><span class="line">        System.out.println(<span class="number">10</span>/<span class="number">0</span>); <span class="comment">//æ¨¡æ‹Ÿå¼‚å¸¸</span></span><br><span class="line">        userDao.addMoney();</span><br><span class="line">        System.out.println(<span class="string">&quot;è½¬è´¦æˆåŠŸ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç›¸å…³å‚æ•°è®¾ç½®"><a href="#ç›¸å…³å‚æ•°è®¾ç½®" class="headerlink" title="ç›¸å…³å‚æ•°è®¾ç½®"></a>ç›¸å…³å‚æ•°è®¾ç½®</h3><p>åœ¨ @Transactional ä¸­å¯ä»¥é…ç½®å’Œäº‹åŠ¡ç›¸å…³çš„å‚æ•°</p>
<p><a href="/img/image-20210107082520535.png" title="image-20210107082520535" class="gallery-item" style="box-shadow: none;"> <img src="/img/image-20210107082520535.png" alt="image-20210107082520535"></a><br>æ¯”å¦‚:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(propagation = Propagation.REQUIRED, isolation = Isolation.DEFAULT, timeout = 10, readOnly = true, rollbackFor = Exception.class)</span></span><br></pre></td></tr></table></figure>

<h4 id="propagationï¼šäº‹åŠ¡ä¼ æ’­è¡Œä¸º"><a href="#propagationï¼šäº‹åŠ¡ä¼ æ’­è¡Œä¸º" class="headerlink" title="propagationï¼šäº‹åŠ¡ä¼ æ’­è¡Œä¸º"></a>propagationï¼šäº‹åŠ¡ä¼ æ’­è¡Œä¸º</h4><ul>
<li>å¤šäº‹åŠ¡æ–¹æ³•ä¹‹é—´è¿›è¡Œè°ƒç”¨çš„æ—¶å€™äº‹åŠ¡å¦‚ä½•ç®¡ç†</li>
</ul>
<p>è®°ä½å‰ä¸¤ä¸ª</p>
<p><a href="/img/image-20210107083445897.png" title="image-20210107083445897" class="gallery-item" style="box-shadow: none;"> <img src="/img/image-20210107083445897.png" alt="image-20210107083445897"></a><br><a href="/img/image-20210107083102949.png" title="image-20210107083102949" class="gallery-item" style="box-shadow: none;"> <img src="/img/image-20210107083102949.png" alt="image-20210107083102949"></a></p>
<h4 id="isolationï¼šäº‹åŠ¡éš”ç¦»çº§åˆ«"><a href="#isolationï¼šäº‹åŠ¡éš”ç¦»çº§åˆ«" class="headerlink" title="isolationï¼šäº‹åŠ¡éš”ç¦»çº§åˆ«"></a>isolationï¼šäº‹åŠ¡éš”ç¦»çº§åˆ«</h4><p>äº‹åŠ¡æœ‰ç‰¹æ€§æˆä¸ºéš”ç¦»æ€§ï¼Œå¤šäº‹åŠ¡æ“ä½œä¹‹é—´ä¸ä¼šäº§ç”Ÿå½±å“ã€‚ä¸è€ƒè™‘éš”ç¦»æ€§äº§ç”Ÿå¾ˆå¤šé—®é¢˜</p>
<p>æœ‰ä¸‰ä¸ªè¯»é—®é¢˜ï¼šè„è¯»ã€ä¸å¯é‡å¤è¯»ã€è™šï¼ˆå¹»ï¼‰è¯»</p>
<ul>
<li><p>è„è¯»ï¼šä¸€ä¸ªæœªæäº¤äº‹åŠ¡è¯»å–åˆ°å¦ä¸€ä¸ªæœªæäº¤äº‹åŠ¡çš„æ•°æ®</p>
</li>
<li><p>ä¸å¯é‡å¤è¯»ï¼šä¸€ä¸ªæœªæäº¤äº‹åŠ¡è¯»å–åˆ°å¦ä¸€æäº¤äº‹åŠ¡ä¿®æ”¹æ•°æ®</p>
</li>
<li><p>è™šè¯»ï¼šä¸€ä¸ªæœªæäº¤äº‹åŠ¡è¯»å–åˆ°å¦ä¸€æäº¤äº‹åŠ¡æ·»åŠ æ•°æ®</p>
</li>
</ul>
<p>è§£å†³ï¼šé€šè¿‡è®¾ç½®äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œè§£å†³è¯»é—®é¢˜</p>
<p><a href="/img/image-20210107083220682.png" title="image-20210107083220682" class="gallery-item" style="box-shadow: none;"> <img src="/img/image-20210107083220682.png" alt="image-20210107083220682"></a></p>
<h4 id="timeoutï¼šè¶…æ—¶æ—¶é—´"><a href="#timeoutï¼šè¶…æ—¶æ—¶é—´" class="headerlink" title="timeoutï¼šè¶…æ—¶æ—¶é—´"></a>timeoutï¼šè¶…æ—¶æ—¶é—´</h4><p>äº‹åŠ¡éœ€è¦åœ¨ä¸€å®šæ—¶é—´å†…è¿›è¡Œæäº¤ï¼Œå¦‚æœä¸æäº¤è¿›è¡Œå›æ»š</p>
<p>é»˜è®¤å€¼æ˜¯ -1 ä¹Ÿå°±æ˜¯ä¸å…è®¸è¶…æ—¶ï¼Œè®¾ç½®æ—¶é—´ä»¥ç§’å•ä½è¿›è¡Œè®¡ç®—</p>
<h4 id="readOnlyï¼šæ˜¯å¦åªè¯»"><a href="#readOnlyï¼šæ˜¯å¦åªè¯»" class="headerlink" title="readOnlyï¼šæ˜¯å¦åªè¯»"></a>readOnlyï¼šæ˜¯å¦åªè¯»</h4><p>è¯»ï¼šæŸ¥è¯¢æ“ä½œï¼Œå†™ï¼šæ·»åŠ ä¿®æ”¹åˆ é™¤æ“ä½œ</p>
<p>readOnly é»˜è®¤å€¼ falseï¼Œè¡¨ç¤ºå¯ä»¥æŸ¥è¯¢ï¼Œå¯ä»¥æ·»åŠ ä¿®æ”¹åˆ é™¤æ“ä½œ</p>
<p>è®¾ç½® readOnly å€¼æ˜¯ trueï¼Œè®¾ç½®æˆ true ä¹‹åï¼Œåªèƒ½æŸ¥è¯¢</p>
<h4 id="rollbackForï¼šå›æ»š"><a href="#rollbackForï¼šå›æ»š" class="headerlink" title="rollbackForï¼šå›æ»š"></a>rollbackForï¼šå›æ»š</h4><p>è®¾ç½®å‡ºç°å“ªäº›å¼‚å¸¸è¿›è¡Œäº‹åŠ¡å›æ»š</p>
<h4 id="noRoolbackForï¼šä¸å›æ»š"><a href="#noRoolbackForï¼šä¸å›æ»š" class="headerlink" title="noRoolbackForï¼šä¸å›æ»š"></a>noRoolbackForï¼šä¸å›æ»š</h4><p>è®¾ç½®å‡ºç°å“ªäº›å¼‚å¸¸ä¸è¿›è¡Œäº‹åŠ¡å›æ»š</p>
<h3 id="å®Œå…¨æ³¨è§£å¼€å‘-1"><a href="#å®Œå…¨æ³¨è§£å¼€å‘-1" class="headerlink" title="å®Œå…¨æ³¨è§£å¼€å‘"></a>å®Œå…¨æ³¨è§£å¼€å‘</h3><p>åˆ›å»ºé…ç½®ç±»ï¼Œä½¿ç”¨é…ç½®ç±»æ›¿ä»£xmlé…ç½®æ–‡ä»¶</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">//é…ç½®ç±»</span></span><br><span class="line"><span class="meta">@ComponentScan(basePackages = &quot;com.Jancoyan&quot;)</span> <span class="comment">//ç»„ä»¶æ‰«æ</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span> <span class="comment">//å¼€å¯äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TxConfig</span> &#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºæ•°æ®åº“è¿æ¥æ± </span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DruidDataSource <span class="title function_">getDruidDataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        dataSource.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql:///user_db&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ›å»º JdbcTemplate å¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> JdbcTemplate <span class="title function_">getJdbcTemplate</span><span class="params">(DataSource dataSource)</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ° ioc å®¹å™¨ä¸­æ ¹æ®ç±»å‹æ‰¾åˆ° dataSource</span></span><br><span class="line">        <span class="type">JdbcTemplate</span> <span class="variable">jdbcTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JdbcTemplate</span>();</span><br><span class="line">        <span class="comment">//æ³¨å…¥ dataSource</span></span><br><span class="line">        jdbcTemplate.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span> jdbcTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ›å»ºäº‹åŠ¡ç®¡ç†å™¨</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSourceTransactionManager</span><br><span class="line">    <span class="title function_">getDataSourceTransactionManager</span><span class="params">(DataSource dataSource)</span> &#123;</span><br><span class="line">        <span class="type">DataSourceTransactionManager</span> <span class="variable">transactionManager</span> <span class="operator">=</span> <span class="keyword">new</span></span><br><span class="line">                <span class="title class_">DataSourceTransactionManager</span>();</span><br><span class="line">        transactionManager.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span> transactionManager;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ä½¿ç”¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>();</span><br></pre></td></tr></table></figure>

<h2 id="6-Spring-5-new-features"><a href="#6-Spring-5-new-features" class="headerlink" title="6. Spring 5 new features"></a>6. Spring 5 new features</h2><h3 id="è‡ªå¸¦é€šç”¨çš„æ—¥å¿—å°è£…"><a href="#è‡ªå¸¦é€šç”¨çš„æ—¥å¿—å°è£…" class="headerlink" title="è‡ªå¸¦é€šç”¨çš„æ—¥å¿—å°è£…"></a>è‡ªå¸¦é€šç”¨çš„æ—¥å¿—å°è£…</h3><p>Spring5æ•´åˆäº†log4j2ã€‚</p>
<p><a href="/img/image-20210107141845730.png" title="image-20210107141845730" class="gallery-item" style="box-shadow: none;"> <img src="/img/image-20210107141845730.png" alt="image-20210107141845730"></a>2. åˆ›å»ºlog4j2.xml é…ç½®æ–‡ä»¶ï¼Œå¿…é¡»æ˜¯è¿™ä¸ªåå­—ï¼Œä¸èƒ½æ˜¯åˆ«çš„ã€‚<br>3. æŠŠä¸‹é¢ä»£ç å¤åˆ¶è¿‡å»</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ—¥å¿—çº§åˆ«ä»¥åŠä¼˜å…ˆçº§æ’åº: OFF &gt; FATAL &gt; ERROR &gt; WARN &gt; INFO &gt; DEBUG &gt; TRACE &gt;</span></span><br><span class="line"><span class="comment">ALL --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Configuration åé¢çš„ status ç”¨äºè®¾ç½® log4j2 è‡ªèº«å†…éƒ¨çš„ä¿¡æ¯è¾“å‡ºï¼Œå¯ä»¥ä¸è®¾ç½®ï¼Œ</span></span><br><span class="line"><span class="comment">å½“è®¾ç½®æˆ trace æ—¶ï¼Œå¯ä»¥çœ‹åˆ° log4j2 å†…éƒ¨å„ç§è¯¦ç»†è¾“å‡º--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">status</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--å…ˆå®šä¹‰æ‰€æœ‰çš„ appender--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">appenders</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--è¾“å‡ºæ—¥å¿—ä¿¡æ¯åˆ°æ§åˆ¶å°--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">console</span> <span class="attr">name</span>=<span class="string">&quot;Console&quot;</span> <span class="attr">target</span>=<span class="string">&quot;SYSTEM_OUT&quot;</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--æ§åˆ¶æ—¥å¿—è¾“å‡ºçš„æ ¼å¼--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%t] %-</span></span></span><br><span class="line"><span class="string"><span class="tag">5level %logger&#123;36&#125; - %msg%n&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">console</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">appenders</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--ç„¶åå®šä¹‰ loggerï¼Œåªæœ‰å®šä¹‰ logger å¹¶å¼•å…¥çš„ appenderï¼Œappender æ‰ä¼šç”Ÿæ•ˆ--&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--rootï¼šç”¨äºæŒ‡å®šé¡¹ç›®çš„æ ¹æ—¥å¿—ï¼Œå¦‚æœæ²¡æœ‰å•ç‹¬æŒ‡å®š Loggerï¼Œåˆ™ä¼šä½¿ç”¨ root ä½œä¸º</span></span><br><span class="line"><span class="comment">é»˜è®¤çš„æ—¥å¿—è¾“å‡º--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">loggers</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;info&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">loggers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Nullable-æ³¨è§£"><a href="#Nullable-æ³¨è§£" class="headerlink" title="@Nullable æ³¨è§£"></a>@Nullable æ³¨è§£</h3><p>@Nullable æ³¨è§£å¯ä»¥ä½¿ç”¨åœ¨æ–¹æ³•ä¸Šé¢ï¼Œå±æ€§ä¸Šé¢ï¼Œå‚æ•°ä¸Šé¢ï¼Œè¡¨ç¤ºæ–¹æ³•è¿”å›å¯ä»¥ä¸ºç©ºï¼Œå±æ€§å€¼å¯ä»¥ ä¸ºç©ºï¼Œå‚æ•°å€¼å¯ä»¥ä¸ºç©º</p>
<h3 id="æ ¸å¿ƒå®¹å™¨æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹é£æ ¼"><a href="#æ ¸å¿ƒå®¹å™¨æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹é£æ ¼" class="headerlink" title="æ ¸å¿ƒå®¹å™¨æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹é£æ ¼"></a>æ ¸å¿ƒå®¹å™¨æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹é£æ ¼</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å‡½æ•°å¼é£æ ¼åˆ›å»ºå¯¹è±¡ï¼Œäº¤ç»™ spring è¿›è¡Œç®¡ç†</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGenericApplicationContext</span><span class="params">()</span> &#123;</span><br><span class="line"> <span class="comment">//1 åˆ›å»º GenericApplicationContext å¯¹è±¡</span></span><br><span class="line"> <span class="type">GenericApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GenericApplicationContext</span>();</span><br><span class="line"> <span class="comment">//2 è°ƒç”¨ context çš„æ–¹æ³•å¯¹è±¡æ³¨å†Œ</span></span><br><span class="line"> context.refresh();</span><br><span class="line"> context.registerBean(<span class="string">&quot;user1&quot;</span>,User.class,() -&gt; <span class="keyword">new</span> <span class="title class_">User</span>());</span><br><span class="line"> <span class="comment">//3 è·å–åœ¨ spring æ³¨å†Œçš„å¯¹è±¡</span></span><br><span class="line"> <span class="comment">// User user = (User)context.getBean(&quot;com.atguigu.spring5.test.User&quot;);</span></span><br><span class="line"> <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User)context.getBean(<span class="string">&quot;user1&quot;</span>);</span><br><span class="line"> System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2021-01-04</span>
            
            
             
        
        </i>
    </div>
    <br>
    
    
        
            
    
            <div class="post-footer-pre-next">
                
                    <span>ä¸Šä¸€ç¯‡ï¼š<a href='/2021/01/09/MyBatis/'>ç¬”è®° | MyBatis</a></span>
                

                
                    <span class="post-footer-pre-next-last-span-right">ä¸‹ä¸€ç¯‡ï¼š<a href="/2020/11/28/Javaweb/">ç¬”è®° | JavaWeb</a>
                    </span>
                
            </div>
    
        
    

    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
             

            
                

            
        </span>
       
    
</div>



<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>Change And Challenge</span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--ç›®å½•-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery/lightgallery.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-thumbnail.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-fullscreen.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-autoplay.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-zoom.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-rotate.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-paper.umd.min.js"></script>




<script type="text/javascript">
     
    if (typeof lightGallery !== "undefined") {
        var options1 = {
            selector: '.gallery-item',
            plugins: [lgThumbnail, lgFullscreen, lgAutoplay, lgZoom, lgRotate, lgPager], // å¯ç”¨æ’ä»¶
            thumbnail: true,          // æ˜¾ç¤ºç¼©ç•¥å›¾
            zoom: true,               // å¯ç”¨ç¼©æ”¾åŠŸ
            rotate: true,             // å¯ç”¨æ—‹è½¬åŠŸèƒ½èƒ½
            autoplay: true,        // å¯ç”¨è‡ªåŠ¨æ’­æ”¾åŠŸèƒ½
            fullScreen: true,      // å¯ç”¨å…¨å±åŠŸèƒ½
            pager: false, //é¡µç ,
            zoomFromOrigin: true,   // ä»åŸå§‹ä½ç½®ç¼©æ”¾
            actualSize: true,       // å¯ç”¨æŸ¥çœ‹å®é™…å¤§å°çš„åŠŸèƒ½
            enableZoomAfter: 300,    // å»¶è¿Ÿç¼©æ”¾ï¼Œç¡®ä¿å›¾ç‰‡åŠ è½½å®Œæˆåå¯ç¼©æ”¾
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1); // ä¿®å¤é€‰æ‹©å™¨
    }
    
</script>


                </div>
            
            
                <!-- å›åˆ°é¡¶éƒ¨çš„æŒ‰é’®-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- è¿”å›çš„æŒ‰é’®-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>
</html>